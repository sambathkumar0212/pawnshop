<!DOCTYPE html>
{% load loan_tags %}
<html>
<head>
    <meta charset="utf-8">
    <title>Loan Agreement - {{ loan.loan_number }}</title>
    <style>
        @page {
            size: a4 portrait;
            margin: 1.8cm;
        }
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 13px; /* Increased from 12px */
            line-height: 1.6;
            color: #333333;
        }
        .document-header {
            display: flex;
            margin-bottom: 30px;
        }
        .logo-section {
            width: 100%;
            text-align: center;
        }
        .header-title {
            font-size: 28px; /* Increased from 24px */
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        .header-subtitle {
            font-size: 20px; /* Increased from 18px */
            color: #4a90e2;
            margin: 5px 0 15px 0;
            font-weight: 600;
            letter-spacing: 1px;
        }
        .header-address {
            font-size: 12px; /* Increased from 11px */
            color: #555;
            margin-bottom: 5px;
        }
        .header-contact {
            font-size: 12px; /* Increased from 11px */
            color: #555;
        }
        .document-divider {
            height: 2px;
            background: linear-gradient(to right, #fff, #4a90e2, #fff);
            margin: 10px 0 20px 0;
        }
        .customer-info {
            background-color: #f8f9fa;
            padding: 12px 15px;
            border-radius: 4px;
            margin-bottom: 25px;
            border-left: 3px solid #4a90e2;
            font-size: 14px; /* Increased from 13px */
            display: flex;
            justify-content: space-between;
        }
        .customer-data {
            flex: 1;
        }
        .customer-label {
            font-weight: 600;
            color: #2c3e50;
        }
        .section {
            margin-bottom: 25px;
        }
        .section-title {
            font-size: 17px; /* Increased from 16px */
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
            padding-bottom: 5px;
            border-bottom: 1px solid #e5e5e5;
        }
        .loan-details {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .loan-details th, .loan-details td {
            padding: 9px; /* Increased from 8px */
            border: 1px solid #ddd;
            text-align: left;
            font-size: 13px; /* Added explicit font size */
        }
        .loan-details th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .items-table th, .items-table td {
            padding: 9px; /* Increased from 8px */
            border: 1px solid #ddd;
            text-align: left;
            font-size: 13px; /* Added explicit font size */
        }
        .items-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }
        .items-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .terms {
            font-size: 13px; /* Increased from 12px */
            margin-top: 25px;
            line-height: 1.6;
        }
        .term-title {
            font-weight: 700;
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 18px; /* Increased from 15px */
            text-align: center;
        }
        .terms ol {
            padding-left: 20px;
        }
        .terms ol li {
            margin-bottom: 10px; /* Increased from 8px */
        }
        .signatures {
            margin-top: 40px;
        }
        .signatures-table {
            width: 100%;
        }
        .signatures-table td {
            width: 50%;
            vertical-align: top;
            padding: 15px;
            font-size: 13px; /* Added explicit font size */
        }
        .signature-line {
            border-top: 1px solid #666;
            margin-top: 50px;
            margin-bottom: 8px;
            width: 80%;
        }
        .borrower-signature {
            text-align: left;
        }
        .authorized-signature {
            text-align: right;
        }
        .authorized-signature .signature-line {
            margin-left: auto; /* Move line to the right */
        }
        .footer {
            margin-top: 40px;
            font-size: 10px; /* Increased from 9px */
            text-align: center;
            color: #777;
        }
        .highlight {
            color: #4a90e2;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- New improved header design -->
    <div class="logo-section">
        <div class="header-title">{{ branch.name }}</div>
        <div class="header-subtitle">GOLD LOAN AGREEMENT</div>
        <div class="header-address">{{ branch.address }}, {{ branch.city }}, {{ branch.state }} - {{ branch.pin_code }}</div>
        <div class="header-contact">Phone: {{ branch.phone }} | Email: {{ branch.email }}</div>
    </div>
    
    <div class="document-divider"></div>
    
    <div class="customer-info">
        <div class="customer-data">
            <span class="customer-label">Borrower:</span> <span class="highlight">{{ customer.first_name }} {{ customer.last_name }} {{ customer.middle_name }}</span>
        </div>
        <div class="customer-data">
            <span class="customer-label">Loan #:</span> {{ loan.loan_number }}
        </div>
        <div class="customer-data">
            <span class="customer-label">Date:</span> {{ loan.issue_date|date:"d/m/Y" }}
        </div>
    </div>

    <div class="section">
        <div class="section-title">LOAN DETAILS</div>
        <table class="loan-details">
            <tr>
                <th>Date of Agreement</th>
                <td>{{ loan.issue_date|date:"d/m/Y" }}</td>
                <th>Loan Term</th>
                <td>1 Year</td>
            </tr>
            <tr>
                <th>Borrower Name</th>
                <td class="highlight">{{ customer.first_name }} {{ customer.last_name }}</td>
                <th>ID Proof Number</th>
                <td>{{ customer.id_number }}</td>
            </tr>
            <tr>
                <th>Address</th>
                <td colspan="3">{{ customer.address }}, {{ customer.city }}, {{ customer.state }} - {{ customer.pin_code }}</td>
            </tr>
            <tr>
                <th>Phone Number</th>
                <td>{{ customer.phone }}</td>
                <th>Email</th>
                <td>{{ customer.email }}</td>
            </tr>
            <tr>
                <th>Principal Amount</th>
                <td class="highlight">Rs. {{ loan.principal_amount|floatformat:2 }}</td>
                <th>Processing Fee</th>
                <td>Rs. {{ loan.processing_fee|floatformat:2 }}</td>
            </tr>
            <tr>
                <th>Distribution Amount</th>
                <td>Rs. {{ loan.distribution_amount|floatformat:2 }}</td>
                <th>Issue Date</th>
                <td>{{ loan.issue_date|date:"d/m/Y" }}</td>
            </tr>
            <tr>
                <th>Total Payable Amount</th>
                <td class="highlight">Rs. {{ loan.total_payable|floatformat:2 }}</td>
                <th>Interest Rate</th>
                <td>{{ loan.interest_rate }}% per annum</td>
            </tr>
            <tr>
                <th>Due Date</th>
                <td class="highlight">{{ loan.due_date|date:"d/m/Y" }}</td>
                <th>Grace Period End</th>
                <td>{{ loan.grace_period_end|date:"d/m/Y" }}</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <div class="section-title">PLEDGED ITEMS</div>
        <table class="items-table">
            <thead>
                <tr>
                    <th>Item Description</th>
                    <th>Gold Karat</th>
                    <th>Gross Weight (g)</th>
                    <th>Net Weight (g)</th>
                </tr>
            </thead>
            <tbody>
                {% for item in loan_items %}
                <tr>
                    <td>{{ item.item.name }}</td>
                    <td>{{ item.gold_karat }}K</td>
                    <td>{{ item.gross_weight|floatformat:3 }}</td>
                    <td>{{ item.net_weight|floatformat:3 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="terms">
        <div class="term-title">Terms & Conditions</div>
        
        <ol>
            <li>The Borrower affirms that the pledged article is their own property and is not stolen or encumbered.</li>
            
            <li>The Lender will retain the pledged article as security for the loan until full repayment of principal
and interest.</li>
            
            <li>The loan is repayable on or before the due date. If not repaid, the Lender may sell the pledged
article as per the provisions of the Indian Contract Act, 1872 and the Pawn Brokers Act, 1943.</li>
            
            <li>Interest will be charged at the agreed rate. Partial payments may be accepted at the Lender's
discretion.</li>
            
            <li>Loss or damage to the pledged article due to natural calamities, theft, or circumstances beyond the
Lender's control will not be the responsibility of the Lender.</li>
            
            <li>On full repayment, the pledged article will be returned to the Borrower against proper identification
and this agreement.</li>
            
            <li>All disputes are subject to the jurisdiction of the local courts.</li>
        </ol>
        <br><br><br>
    </div>

    <div class="signatures">
        <table class="signatures-table">
            <tr>
                <td class="borrower-signature">
                    <div class="signature-line"></div>
                    <p>Borrower Signature<br>
                    {{ customer.first_name }} {{ customer.last_name }}</p>
                </td>
                <td class="authorized-signature">
                    <div class="signature-line"></div>
                    <p>Authorized Signatory<br>
                    {{ branch.name }}</p>
                </td>
            </tr>
        </table>
    </div>

    <div class="footer">
        <p>Document generated on: {{ date_today|date:"d/m/Y" }}</p>
    </div>
</body>
</html>